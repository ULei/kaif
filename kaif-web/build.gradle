buildscript {
  ext {
    springBootVersion = '1.2.1.RELEASE'
  }
  dependencies {
    classpath("org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}")

    // enable advance class hot swap. don't know if work
    // classpath 'org.springframework:springloaded:1.2.0.RELEASE'
  }
}

apply plugin: 'spring-boot'
apply plugin: 'war'

bootRepackage {
  mainClass = 'io.kaif.Application'
}

springBoot {
  mainClass = 'io.kaif.Application'
}

// hack to make `gradle bootRun` start with dev mode
tasks.withType(org.springframework.boot.gradle.run.BootRunTask) {
  systemProperty('spring.profiles.active', 'dev')
}

jar {
  baseName = 'kaif-web'
}

war {
  baseName = 'kaif-web'
}

dependencies {
  // compile("org.springframework.boot:spring-boot-starter-data-elasticsearch")
  // compile("org.springframework.boot:spring-boot-starter-websocket")

  compile("org.springframework.boot:spring-boot-starter-jdbc")
  compile("org.springframework.boot:spring-boot-starter-freemarker")
  compile("org.springframework.boot:spring-boot-starter-web")

  //TODO remove tomcat jdbc, use better connection pool
  //exclude embed tomcat in production
  providedRuntime("org.springframework.boot:spring-boot-starter-tomcat")

  compile("org.springframework.boot:spring-boot-starter-social-twitter")
  compile("org.springframework.boot:spring-boot-starter-actuator")
  compile("org.springframework.boot:spring-boot-starter-remote-shell")
  testCompile("org.springframework.boot:spring-boot-starter-test")

  compile 'org.postgresql:postgresql:9.3-1102-jdbc41'
  compile 'com.google.guava:guava:18.0'

  // note that guava depends on jsr305 1.3.8
  compile 'com.google.code.findbugs:jsr305:3.0.0'

  compile 'com.fasterxml.jackson.module:jackson-module-afterburner:2.4.0'
}

